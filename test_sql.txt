 SELECT hisorderdetail.dishname,          hisorderdetail.unit,  			sum(hisorderdetail.quantity*hisorderdetail.price*hisorderdetail.discount_rate),   			sum(hisorderdetail.quantity*hisorderdetail.price),   			sum(hisorderdetail.quantity*hisorderdetail.price*(1 - hisorderdetail.discount_rate)),  			hisorderdetail.dishtype,sum(hisorderdetail.quantity),          hisorderdetail.dish_id,         sum(case when hisorderdetail.price = 0 then hisorderdetail.quantity * a.price else 0 end) as rela_amount     FROM {oj hisorderdetail LEFT OUTER JOIN dish as a ON hisorderdetail.dish_id = a.dish_id},            hisorder      WHERE ( hisorder.hisorder_id = hisorderdetail.hisorder_id )    and date(dateadd(hour,-5,hisorder.bill_date)) Between '2016/07/01' and '2016/07/21'  and 1 = 1  and 1 = 1  and hisorderdetail.dishtype_id = '07'  and 1 = 1  and 1 = 1  and 1 = 1  and 1 = 1  and 1 = 1  GROUP BY hisorderdetail.dish_id,hisorderdetail.dishname, hisorderdetail.unit,hisorderdetail.dishtype,a.dish_id   ORDER BY sum(hisorderdetail.quantity) DESC 
